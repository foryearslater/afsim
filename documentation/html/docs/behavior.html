
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>behavior &#8212; AFSIM 2.9.0 Documentation</title>
    <link rel="stylesheet" href="../_static/wsftheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapse.css" />
    <link rel="stylesheet" type="text/css" href="../_static/admonition.css" />
    <link rel="stylesheet" type="text/css" href="../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pseudo-header.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pseudo-topic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/quick-search.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/collapse_sections.js"></script>
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="behavior_tree" href="behavior_tree.html" />
    <link rel="prev" title="bearing_only" href="bearing_only.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../wsf-classindex.html" title="Script Class Index"
             >classes</a> |</li>
        <li class="right" >
          <a href="../wsf-commandindex.html" title="Command Index"
             >commands</a> |</li>
        <li class="right" >
          <a href="../wsf-modelindex.html" title="Model Index"
             >models</a> |</li>
        <li class="right" >
          <a href="../wsf-demoindex.html" title="Demo Index"
             >demos</a> |</li>
        <li class="right" >
          <a href="behavior_tree.html" title="behavior_tree"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bearing_only.html" title="bearing_only"
             accesskey="P">previous</a> |</li>
  <li>
    <img src="../_static/relbar_logo.png" alt=""
         style="vertical-align: middle; margin-top: -2px" />
  </li>
  <li>
    <a href="main_page.html">AFSIM 2.9.0 Documentation</a> &#187;
  </li>
  
        <li class="nav-item nav-item-0"><a href="../site_index.html">Site Index</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="behavior">
<h1>behavior<a class="headerlink" href="#behavior" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#behavior-mode-of-operation" id="id2">Behavior Mode of Operation</a></p></li>
<li><p><a class="reference internal" href="#behavior-node-components" id="id3">Behavior Node Components</a></p></li>
<li><p><a class="reference internal" href="#military-specific" id="id4">Military Specific</a></p></li>
</ul>
</div>
<dl class="command">
<dt id="behavior">
behavior<a class="headerlink" href="#behavior" title="Permalink to this definition">¶</a></dt>
<dd><pre class="literal-block"><a class="reference internal" href="#behavior">behavior</a> &lt;type-name&gt;
  script_variables ... end_script_variables
  on_init          ... end_on_init
  on_message       ... end_on_message
  precondition     ... end_precondition
  on_new_execute   ... end_on_new_execute
  on_new_fail      ... end_on_new_fail
  execute          ... end_execute
  &lt;finite state machine inputs&gt;
  &lt;zero or more nodes&gt;
end_behavior</pre>
</dd></dl>

<section id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A behavior (also called a behavior node or a leaf node) is one of the two basic node types used by a <a class="reference internal" href="behavior_tree.html#behavior_tree" title="behavior_tree"><span class="xref wsf wsf-command">behavior_tree</span></a>.  A behavior is defined globally at the simulation level.  Every behavior defined in a scenario must be given a unique name.  Once a behavior is defined, any behavior tree can use it, by referencing it by name.</p>
</section>
<section id="behavior-mode-of-operation">
<h2><a class="toc-backref" href="#id2">Behavior Mode of Operation</a><a class="headerlink" href="#behavior-mode-of-operation" title="Permalink to this headline">¶</a></h2>
<p>Behavior nodes themselves can have child nodes of any type; child nodes are executed after the behavior performs its execute script.  Behavior nodes can also have a finite state machine (FSM) on them, one per behavior node.  To implement the FSM, define states with transition rules inside the behavior block.  The transition rules are defined using the <a class="reference internal" href="script.html#script"><span class="std std-ref">WSF scripting language</span></a>.  The FSM is evaluated after the child nodes of a behavior are executed.</p>
<p>In summary, a behavior node processes itself in this order:</p>
<ul class="simple">
<li><p>The behavior node’s on_init script block is run when the owning processor initializes in the simulation</p></li>
<li><p>The behavior_tree has to traverse to the node when it updates (the node’s position in the tree determines if this happens)</p></li>
<li><p>The node’s precondition script block is run</p></li>
<li><p>If the precondition returns false, and the node was ran last time, then:</p>
<ul>
<li><p>The node’s on_new_fail script is run</p></li>
</ul>
</li>
<li><p>If the precondition returns successful, then:</p>
<ul>
<li><p>If the node was not ran last time, it’s on_new_execute script is run</p></li>
<li><p>The node’s execute script block is run (if exists)</p></li>
<li><p>The node’s children nodes are run (if exist)</p></li>
<li><p>The node’s finite state machine is run (if exists), current state evaluated and zero or one state transitions made</p></li>
</ul>
</li>
</ul>
</section>
<section id="behavior-node-components">
<h2><a class="toc-backref" href="#id3">Behavior Node Components</a><a class="headerlink" href="#behavior-node-components" title="Permalink to this headline">¶</a></h2>
<dl class="command">
<dt id="behavior.behavior">
<span id="behavior"></span>behavior<em> &lt;type-name&gt;</em> … end_behavior<a class="headerlink" href="#behavior.behavior" title="Permalink to this definition">¶</a></dt>
<dd><p>The following script blocks comprised the guts of a behavior:</p>
</dd></dl>

<dl class="command">
<dt id="behavior.on_init">
<span id="on_init"></span>on_init … end_on_init<a class="headerlink" href="#behavior.on_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Behaviors have an on_init script block to help them initialize any necessary member variables or perform any
preprocessing.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.on_message">
<span id="on_message"></span>on_message … end_on_message<a class="headerlink" href="#behavior.on_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Behaviors can received and process messages.  Be sure the comm is linked to the processor that the behavior is on.  See the <a class="reference internal" href="wsf_script_processor.html#WSF_SCRIPT_PROCESSOR" title="WSF_SCRIPT_PROCESSOR"><span class="xref wsf wsf-model">script processor on_message section</span></a> for more information on using this feature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">behavior</span> <span class="n">test_node</span>
  <span class="n">on_message</span>
    <span class="n">default</span>
      <span class="n">script</span>
        <span class="n">writeln</span><span class="p">(</span><span class="s2">&quot;received message &quot;</span><span class="p">,</span> <span class="n">MESSAGE</span><span class="o">.</span><span class="n">Type</span><span class="p">(),</span> <span class="s2">&quot; from &quot;</span><span class="p">,</span> <span class="n">MESSAGE</span><span class="o">.</span><span class="n">Originator</span><span class="p">());</span>
      <span class="n">end_script</span>
  <span class="n">end_on_message</span>
<span class="n">end_behavior</span>
</pre></div>
</div>
</dd></dl>

<dl class="command">
<dt id="behavior.precondition">
<span id="precondition"></span>precondition … end_precondition<a class="headerlink" href="#behavior.precondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Every behavior must have a precondition script block that returns either a true/false Boolean value or a real number. Some parent nodes will check a behavior’s precondition and use its return value as a real number and some will use its return value as a Boolean number.  If a precondition returns true/false and it’s used a real number, then “true” equates to 1.0 and “false” equates to 0.0.  If a precondition returns a real number and it’s used as a Boolean than 0.0 equates to “false” and everything else equates to “true.”  Any tree or node that owns this behavior uses the precondition to determine whether or not that behavior will execute, and subsequently how the whole tree will be traversed and processed on each update.  The node types that use real numbers are <a class="reference internal" href="behavior_tree.html#behavior_tree.priority_selector" title="priority_selector (behavior_tree)"><span class="xref wsf wsf-command">priority_selector</span></a> and <a class="reference internal" href="behavior_tree.html#behavior_tree.weighted_random" title="weighted_random (behavior_tree)"><span class="xref wsf wsf-command">weighted_random</span></a> connector nodes.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.on_new_execute">
<span id="on_new_execute"></span>on_new_execute … end_on_new_execute<a class="headerlink" href="#behavior.on_new_execute" title="Permalink to this definition">¶</a></dt>
<dd><p>If a behavior node is run and was not ran last update, then this script block is run.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.on_new_fail">
<span id="on_new_fail"></span>on_new_fail … end_on_new_fail<a class="headerlink" href="#behavior.on_new_fail" title="Permalink to this definition">¶</a></dt>
<dd><p>If a behavior node is not run and was ran last update, then this script block is run.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.execute">
<span id="execute"></span>execute … end_execute<a class="headerlink" href="#behavior.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>If a behavior node is traversed to by the tree, and its precondition returns a value that the parent node uses to select it for execution, then the behavior’s execute script is performed.  This script block should be significant, it is what the behavior exists for.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.show_state_evaluations">
<span id="show_state_evaluations"></span>show_state_evaluations<a class="headerlink" href="#behavior.show_state_evaluations" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that information about state evaluations should be written to standard output. This essentially shows the true or false status of the evaluation of each next_state block.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.show_state_transitions">
<span id="show_state_transitions"></span>show_state_transitions<a class="headerlink" href="#behavior.show_state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that information about state transitions should be written to standard output.</p>
</dd></dl>

<dl class="command">
<dt id="behavior.state">
<span id="state"></span>state<em> &lt;state-name&gt;</em><a class="headerlink" href="#behavior.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a state in a state machine with the name &lt;state-name&gt;.  Notice that states can have their own behavior tree within them; it is updated when the state is evaluated.</p>
<pre class="literal-block">state &lt;state-name&gt;
  on_entry
     <a class="reference internal" href="script.html#script"><span class="std std-ref">… Script Body …</span></a>
  end_on_entry
  on_exit
     <a class="reference internal" href="script.html#script"><span class="std std-ref">… Script Body …</span></a>
  end_on_exit
  next_state &lt;next-state-name-1&gt;
     <a class="reference internal" href="script.html#script"><span class="std std-ref">… Script Body …</span></a>
  end_next_state
  next_state &lt;next-state-name-n&gt;
     <a class="reference internal" href="script.html#script"><span class="std std-ref">… Script Body …</span></a>
  end_next_state
  <a class="reference internal" href="behavior_tree.html#behavior_tree" title="behavior_tree"><span class="xref wsf wsf-command">behavior_tree</span></a>
     <em>... :command:`Behavior Tree Commands &lt;behavior_tree&gt;` ...</em>
  end_behavior_tree
end_state</pre>
</dd></dl>

</section>
<section id="military-specific">
<h2><a class="toc-backref" href="#id4">Military Specific</a><a class="headerlink" href="#military-specific" title="Permalink to this headline">¶</a></h2>
<p><em>Example Behavior</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># this behavior checks to make sure the platform has a target and a weapon</span>
<span class="c1"># it also checks that this weapon has not already been used</span>
<span class="c1"># if the precondition passes, it tries to fire once at the target</span>

<span class="n">behavior</span> <span class="n">check_and_fire</span>

  <span class="n">script_variables</span>
    <span class="n">WsfWeapon</span> <span class="n">myWeapon</span><span class="p">;</span>
  <span class="n">end_script_variables</span>

  <span class="n">on_init</span>
    <span class="n">myWeapon</span> <span class="o">=</span> <span class="n">PLATFORM</span><span class="o">.</span><span class="n">WeaponEntry</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  <span class="c1">#just grabs the first defined weapon</span>
  <span class="n">end_on_init</span>

  <span class="n">precondition</span>
    <span class="n">WsfTrack</span> <span class="n">myTarget</span> <span class="o">=</span> <span class="n">PLATFORM</span><span class="o">.</span><span class="n">CurrentTargetTrack</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">myWeapon</span><span class="o">.</span><span class="n">IsValid</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">myTarget</span><span class="o">.</span><span class="n">IsValid</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">myWeapon</span><span class="o">.</span><span class="n">TotalQuantityUsed</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
  <span class="n">end_precondition</span>

  <span class="n">execute</span>
    <span class="n">WsfTrack</span> <span class="n">myTarget</span> <span class="o">=</span> <span class="n">PLATFORM</span><span class="o">.</span><span class="n">CurrentTargetTrack</span><span class="p">();</span>  <span class="c1">#should be valid, if precondition passed</span>
    <span class="n">myWeapon</span><span class="o">.</span><span class="n">Fire</span><span class="p">(</span><span class="n">myTarget</span><span class="p">);</span>
  <span class="n">end_execute</span>

<span class="n">end_behavior</span>
</pre></div>
</div>
</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    <p class="logo"><a href="main_page.html">
      <img class="logo" src="../_static/sidebar_logo.png" alt="Logo"/>
    </a></p>
  

<script src="../_static/extension.js"></script>
<p>
   <ul class="Core-menu">
      <li><a href="main_page.html">Main Page</a></li>
      <li><a href="changelog/afsim_2.9.html">Changelog</a> | <a href="afsim_change_log.html">History</a></li>
      <li><a href="documents.html">Documents</a></li>
      <li><a href="security_info.html">Security Information</a></li>
      <li><a href="contact_info.html">Contact Information</a></li>
   </ul>
</p>

<br>
<hr>
<br>

<p>
   <h3>Core Apps</h3>
   <ul class="Core-menu">
     <li><a href="wsf_core.html">Main Page</a></li>
     <li><a href="wsf_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/wsf_2.9.html">Changelog</a> | <a href="wsf_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Demos</h3>
   <ul class="DEMOS-menu">
     <li><a href="changelog/demos_2.9.html">Changelog</a> | <a href="demos_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Mystic</h3>
   <ul class="Mystic-menu">
     <li><a href="mystic.html">Main Page</a></li>
     <li><a href="mystic_users_guide.html">User's Guide</a></li>
     <li><a href="mystic_reference_guide.html">Reference Guide</a></li>
     <li><a href="pymystic.html">Batch Processing</a></li>
     <li><a href="changelog/mystic_2.9.html">Changelog</a> | <a href="mystic_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Warlock</h3>
   <ul class="WARLOCK-menu">
     <li><a href="warlock.html">Main Page</a></li>
     <li><a href="warlock_users_guide.html">User's Guide</a></li>
     <li><a href="warlock_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/warlock_2.9.html">Changelog</a> | <a href="warlock_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Wizard</h3>
   <ul class="WIZARD-menu">
     <li><a href="wizard.html">Main Page</a></li>
     <li><a href="wizard_users_guide.html">User's Guide</a></li>
     <li><a href="wizard_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/wizard_2.9.html">Changelog</a> | <a href="wizard_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>EVT Reader</h3>
   <ul class="EvtReader-menu">
     <li><a href="evtreader.html">Main Page</a></li>
   </ul>
</p>

<p>
   <h3>Mover Creator</h3>
   <ul class="MoverCreator-menu">
     <li><a href="mover_creator.html">Main Page</a></li>
     <li><a href="mc_users_guide.html">User's Guide</a></li>
     <li><a href="mc_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/mover_creator_2.9.html">Changelog</a> | <a href="mc_change_log.html">History</a></li>
   </ul>
</p>

<br>
<hr>
<br>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/behavior.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../wsf-classindex.html" title="Script Class Index"
             >classes</a> |</li>
        <li class="right" >
          <a href="../wsf-commandindex.html" title="Command Index"
             >commands</a> |</li>
        <li class="right" >
          <a href="../wsf-modelindex.html" title="Model Index"
             >models</a> |</li>
        <li class="right" >
          <a href="../wsf-demoindex.html" title="Demo Index"
             >demos</a> |</li>
        <li class="right" >
          <a href="behavior_tree.html" title="behavior_tree"
             >next</a> |</li>
        <li class="right" >
          <a href="bearing_only.html" title="bearing_only"
             >previous</a> |</li>
  <li>
    <img src="../_static/relbar_logo.png" alt=""
         style="vertical-align: middle; margin-top: -2px" />
  </li>
  <li>
    <a href="main_page.html">AFSIM 2.9.0 Documentation</a> &#187;
  </li>
  
        <li class="nav-item nav-item-0"><a href="../site_index.html">Site Index</a> &#187;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Multiple, All Rights Reserved.
      Last updated on Feb 25, 2022.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>