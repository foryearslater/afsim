
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT &#8212; AFSIM 2.9.0 Documentation</title>
    <link rel="stylesheet" href="../_static/wsftheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapse.css" />
    <link rel="stylesheet" type="text/css" href="../_static/admonition.css" />
    <link rel="stylesheet" type="text/css" href="../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pseudo-header.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pseudo-topic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/quick-search.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/collapse_sections.js"></script>
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="WSF_CYBER_SCRIPT_EFFECT" href="wsf_cyber_script_effect.html" />
    <link rel="prev" title="WSF_CYBER_DETONATE_EFFECT" href="wsf_cyber_detonate_effect.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../wsf-classindex.html" title="Script Class Index"
             >classes</a> |</li>
        <li class="right" >
          <a href="../wsf-commandindex.html" title="Command Index"
             >commands</a> |</li>
        <li class="right" >
          <a href="../wsf-modelindex.html" title="Model Index"
             >models</a> |</li>
        <li class="right" >
          <a href="../wsf-demoindex.html" title="Demo Index"
             >demos</a> |</li>
        <li class="right" >
          <a href="wsf_cyber_script_effect.html" title="WSF_CYBER_SCRIPT_EFFECT"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wsf_cyber_detonate_effect.html" title="WSF_CYBER_DETONATE_EFFECT"
             accesskey="P">previous</a> |</li>
  <li>
    <img src="../_static/relbar_logo.png" alt=""
         style="vertical-align: middle; margin-top: -2px" />
  </li>
  <li>
    <a href="main_page.html">AFSIM 2.9.0 Documentation</a> &#187;
  </li>
  
        <li class="nav-item nav-item-0"><a href="../site_index.html">Site Index</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="wsf-cyber-man-in-the-middle-effect">
<h1>WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT<a class="headerlink" href="#wsf-cyber-man-in-the-middle-effect" title="Permalink to this headline">¶</a></h1>
<dl class="model">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT">
cyber_effect WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<pre class="literal-block">cyber_effect &lt;effect_name&gt; <a class="reference internal" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT" title="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT"><span class="xref wsf wsf-model">WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT</span></a>

   <a class="reference internal" href="#platform_type">platform_type</a> &lt;type&gt;
      ... <a class="reference internal" href="#comm-effect">comm_effect</a> commands
      <a class="reference internal" href="#target_list">target_list</a>
         &lt;comm1&gt;
         &lt;comm2&gt;
         ...
         &lt;commN&gt;
      end_target_list

      <a class="reference internal" href="#all">all</a>

      <a class="reference internal" href="#exfiltrate">exfiltrate</a> &lt;boolean&gt;

      script <a class="reference internal" href="script/wsfcybermitmmessage.html#WsfCyberMitmMessage" title="WsfCyberMitmMessage"><span class="xref wsf wsf-class">WsfCyberMitmMessage</span></a> <a class="reference internal" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnSend" title="OnSend (WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT)"><span class="xref wsf wsf-command">OnSend</span></a> ...
      script <a class="reference internal" href="script/wsfcybermitmmessage.html#WsfCyberMitmMessage" title="WsfCyberMitmMessage"><span class="xref wsf wsf-class">WsfCyberMitmMessage</span></a> <a class="reference internal" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnReceive" title="OnReceive (WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT)"><span class="xref wsf wsf-command">OnReceive</span></a> ...
   end_platform_type

   <a class="reference internal" href="#platform">platform</a> &lt;name&gt;
      ... <a class="reference internal" href="#comm-effect">comm_effect</a> commands
   end_platform

   <a class="reference internal" href="#default">default</a>
      ... <a class="reference internal" href="#comm-effect">comm_effect</a> commands
   end_default

end_cyber_effect</pre>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT" title="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT"><span class="xref wsf wsf-model">WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT</span></a> is a cyber_effect that allows the injection of a man-in-the-middle
attack on the victim. The effect will allow the user to drop, delay, and alter any incoming or outgoing
messages from the victim platform.</p>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h2>
<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.platform_type">
<span id="platform_type"></span>platform_type<em> &lt;type&gt;</em> … end_platform_type<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.platform_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the affected comms and effect behaviors for a platform type.
This command may be repeated as necessary.</p>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.platform">
<span id="platform"></span>platform<em> &lt;name&gt;</em> … end_platform<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.platform" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the affected comms and effect behaviors for a specific platform.
This command may be repeated as necessary.</p>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.default">
<span id="default"></span>default … end_default<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the default comms and behaviors of the attack if the victim is not
of any previously specified platforms or platform types.</p>
</dd></dl>

<section id="common-victim-commands">
<span id="comm-effect"></span><h3>Common Victim Commands<a class="headerlink" href="#common-victim-commands" title="Permalink to this headline">¶</a></h3>
<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.target_list">
<span id="target_list"></span>target_list … end_target_list<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.target_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies comm devices by name on the victim platform that will be affected by this effect. If a comm is
listed, but does not exist on the victim platform when the effect is applied, then it will be disregarded.</p>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.all">
<span id="all"></span>all<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies that all comms on the victim platform will be affected by this effect.</p>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.exfiltrate">
<span id="exfiltrate"></span>exfiltrate<a class="reference internal" href="argumenttypes.html#boolean" title="boolean"><em> &lt;boolean&gt;</em></a><a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.exfiltrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies that this comm should attempt to forward every message it receives back to the attacker.
This will attempt to send the message to the first comm on the attacker that is reachable from the victim comm.
Any message exfiltrated this way will be marked with an <code class="code docutils literal notranslate"><span class="pre">EXFILTRATED_MESSAGE</span></code> aux-data field. The forwarded message
will be marked with the <code class="code docutils literal notranslate"><span class="pre">EXFILTRATION_MESSAGE</span></code> aux-data field.</p>
<p><strong>Default</strong> false</p>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnSend">
<span id="OnSend"></span>OnSend (script)<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnSend" title="Permalink to this definition">¶</a></dt>
<dd><p>A provided script that will be called when a specified comm attempts to send a message. This script allows
for the ability to alter, delay, or drop a WsfMessage.</p>
<p>An example to drop a message is as follows:</p>
<pre class="literal-block">script <a class="reference internal" href="script/wsfcybermitmmessage.html#WsfCyberMitmMessage" title="WsfCyberMitmMessage"><span class="xref wsf wsf-class">WsfCyberMitmMessage</span></a> OnSend(<a class="reference internal" href="script/wsfmessage.html#WsfMessage" title="WsfMessage"><span class="xref wsf wsf-class">WsfMessage</span></a> aMessage)
   # Set drop to true to drop the message
   return WsfCyberMitmMessage.Construct(aMessage, 0, true);
end_script</pre>
</dd></dl>

<dl class="command">
<dt id="WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnReceive">
<span id="OnReceive"></span>OnReceive (script)<a class="headerlink" href="#WSF_CYBER_MAN_IN_THE_MIDDLE_EFFECT.OnReceive" title="Permalink to this definition">¶</a></dt>
<dd><p>A provided script that will be called when a specified comm attempts to receive a message. This script
allows for the ability to alter, delay, or drop a WsfMessage.</p>
<p>An example to delay a message is as follows:</p>
<pre class="literal-block">script <a class="reference internal" href="script/wsfcybermitmmessage.html#WsfCyberMitmMessage" title="WsfCyberMitmMessage"><span class="xref wsf wsf-class">WsfCyberMitmMessage</span></a> OnReceive(<a class="reference internal" href="script/wsfmessage.html#WsfMessage" title="WsfMessage"><span class="xref wsf wsf-class">WsfMessage</span></a> aMessage)
   # Delay the message by 10 seconds
   return WsfCyberMitmMessage.Construct(aMessage, 10, false);
end_script</pre>
</dd></dl>

</section>
</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    <p class="logo"><a href="main_page.html">
      <img class="logo" src="../_static/sidebar_logo.png" alt="Logo"/>
    </a></p>
  

<script src="../_static/extension.js"></script>
<p>
   <ul class="Core-menu">
      <li><a href="main_page.html">Main Page</a></li>
      <li><a href="changelog/afsim_2.9.html">Changelog</a> | <a href="afsim_change_log.html">History</a></li>
      <li><a href="documents.html">Documents</a></li>
      <li><a href="security_info.html">Security Information</a></li>
      <li><a href="contact_info.html">Contact Information</a></li>
   </ul>
</p>

<br>
<hr>
<br>

<p>
   <h3>Core Apps</h3>
   <ul class="Core-menu">
     <li><a href="wsf_core.html">Main Page</a></li>
     <li><a href="wsf_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/wsf_2.9.html">Changelog</a> | <a href="wsf_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Demos</h3>
   <ul class="DEMOS-menu">
     <li><a href="changelog/demos_2.9.html">Changelog</a> | <a href="demos_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Mystic</h3>
   <ul class="Mystic-menu">
     <li><a href="mystic.html">Main Page</a></li>
     <li><a href="mystic_users_guide.html">User's Guide</a></li>
     <li><a href="mystic_reference_guide.html">Reference Guide</a></li>
     <li><a href="pymystic.html">Batch Processing</a></li>
     <li><a href="changelog/mystic_2.9.html">Changelog</a> | <a href="mystic_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Warlock</h3>
   <ul class="WARLOCK-menu">
     <li><a href="warlock.html">Main Page</a></li>
     <li><a href="warlock_users_guide.html">User's Guide</a></li>
     <li><a href="warlock_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/warlock_2.9.html">Changelog</a> | <a href="warlock_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>Wizard</h3>
   <ul class="WIZARD-menu">
     <li><a href="wizard.html">Main Page</a></li>
     <li><a href="wizard_users_guide.html">User's Guide</a></li>
     <li><a href="wizard_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/wizard_2.9.html">Changelog</a> | <a href="wizard_change_log.html">History</a></li>
   </ul>
</p>

<p>
   <h3>EVT Reader</h3>
   <ul class="EvtReader-menu">
     <li><a href="evtreader.html">Main Page</a></li>
   </ul>
</p>

<p>
   <h3>Mover Creator</h3>
   <ul class="MoverCreator-menu">
     <li><a href="mover_creator.html">Main Page</a></li>
     <li><a href="mc_users_guide.html">User's Guide</a></li>
     <li><a href="mc_reference_guide.html">Reference Guide</a></li>
     <li><a href="changelog/mover_creator_2.9.html">Changelog</a> | <a href="mc_change_log.html">History</a></li>
   </ul>
</p>

<br>
<hr>
<br>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/wsf_cyber_man_in_the_middle_effect.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../wsf-classindex.html" title="Script Class Index"
             >classes</a> |</li>
        <li class="right" >
          <a href="../wsf-commandindex.html" title="Command Index"
             >commands</a> |</li>
        <li class="right" >
          <a href="../wsf-modelindex.html" title="Model Index"
             >models</a> |</li>
        <li class="right" >
          <a href="../wsf-demoindex.html" title="Demo Index"
             >demos</a> |</li>
        <li class="right" >
          <a href="wsf_cyber_script_effect.html" title="WSF_CYBER_SCRIPT_EFFECT"
             >next</a> |</li>
        <li class="right" >
          <a href="wsf_cyber_detonate_effect.html" title="WSF_CYBER_DETONATE_EFFECT"
             >previous</a> |</li>
  <li>
    <img src="../_static/relbar_logo.png" alt=""
         style="vertical-align: middle; margin-top: -2px" />
  </li>
  <li>
    <a href="main_page.html">AFSIM 2.9.0 Documentation</a> &#187;
  </li>
  
        <li class="nav-item nav-item-0"><a href="../site_index.html">Site Index</a> &#187;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Multiple, All Rights Reserved.
      Last updated on Feb 25, 2022.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>